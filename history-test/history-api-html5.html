<!DOCTYPE html>
<html>
<head>
    <title>Html5 History api</title>
    <script type="text/javascript">
        window.onload = function () {
            ////// The history attribute of the Window interface must return the object implementing the History interface for that Window object's Document.
            ////// History - interface
            // вешаем событие на popstate которое срабатывает
            // при нажатии back/forward в браузере
            window.onpopstate = function (e) {
                ////console.log(window.history.location);
                ////console.log(window.location);
                ////console.log(document.location);
                // просто сообщение
                console.log(window.history);
                appendText('<b>Вы вернулись на страницу:</b> ' +
                    '<span style="color: green;">' + (window.history.location || window.location.href) + '</span>' +
                    '<br/><b>state:</b> <span style="color: green;">' +
                    JSON.stringify(history.state) + '</span><br/><br/>');

                // тут можете вызвать подгруздку данных и т.п.
                // ...
            };

            // просто функция добавляет DIV с нужным нам текстом
            function appendText(text) {
                var div = document.createElement("div");
                div.innerHTML = text;
                document.body.appendChild(div);
            }

            (function (myDocument, myHistory, undefined) {
                // функция для ссылок обрабатывается при клике на ссылку
                function handlerAnchors() {
                    // State objects are intended to be used for two main purposes:
                    // first, storing a preparsed description of the state in the URL so that in the simple case an author doesn't have to do the parsing
                    // (though one would still need the parsing for handling URLs passed around by users, so it's only a minor optimization),
                    // and second, so that the author can store state that one wouldn't store in the URL
                    // because it only applies to the current Document instance and it would have to be reconstructed if a new Document were opened.

                    // An example of the latter would be something like keeping track of the precise coordinate from which a pop-up div was made to animate,
                    // so that if the user goes back, it can be made to animate to the same location.
                    // Or alternatively, it could be used to keep a pointer into a cache of data that would be fetched from the server based on the information in the URL,
                    // so that when going back and forward, the information doesn't have to be fetched again.
                    // заполним хранилище чем нибудь
                    var state = {
                        title: this.getAttribute("title"),
                        url: this.getAttribute("href", 2) // двоечка нужна для ИЕ6-7
                    }

                    // заносим ссылку в историю
                    myHistory.pushState(state, state.title, state.url);

                    // тут можете вызвать подгруздку данных и т.п.
                    // ...

                    appendText('<b>Вы перешли по ссылке:</b> ' +
                                    '<span style="color: green;">' + state.url + '</span>');

                    // не даем выполнить действие по умолчанию
                    return false;
                }

                // ищем все ссылки
                var anchors = myDocument.getElementsByTagName('a');

                // вешаем события на все ссылки в нашем документе
                for (var i = 0; i < anchors.length; i++) {
                    anchors[i].onclick = handlerAnchors;
                }
            })(document, window.history);
        };
    </script>
</head>
<body>
    <h1>Переходите по ссылкам, а затем жмите в браузере кнопки back/forward</h1>
    <a href="/history-test-link1.html" title="Заголовок связанный с ссылкой My Link">My Link</a>
    <a href="/history-test-link2.html" title="Заголовок связанный с ссылкой Other Link">Other Link</a>
</body>
</html>